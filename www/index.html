<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>
       <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

    <!-- your app's js -->
    <script src="js/app.js"></script>
  </head>
  <body ng-app="RecordLoL">



<ion-side-menus>
<!-- Center content -->
<ion-side-menu-content>
  <ion-header-bar class="bar-positive">
     <button menu-toggle="left" class="button button-icon icon ion-navicon"></button>
    <h1 class="title">RecordLoL</h1>
  </ion-header-bar>
  <ion-content>






<div class="app">
 <img class="fit" src="img/challenger.png">


<div class="list">
  <div class="item item-input-inset">
    <label class="item-input-wrapper">
<input type="text" placeholder="Summoner Name:Region" id="name1"/>
</label>


  </div>





    <div class="item item-input-inset">
    <label class="item-input-wrapper">
<input type="text" placeholder="Summoner Name:Region" id="name2"/>
    </label>
  </div>

    <div class="item item-input-inset">
    <label class="item-input-wrapper">
<input type="text" placeholder="Summoner Name:Region" id="name3"/>
    </label>
  </div>

    <div class="item item-input-inset">
    <label class="item-input-wrapper">
<input type="text" placeholder="Summoner Name:Region" id="name4"/>
    </label>
  </div>

    <div class="item item-input-inset">
    <label class="item-input-wrapper">
<input type="text" placeholder="Summoner Name:Region" id="name5"/>
    </label>
  </div>

</div>




   <!--ion-toggle toggle-class="toggle-balanced"
                    ng-model="Record" ng-controller="tog">
                   <!-- ng-true-value="NotRecording"
                    ng-false-value="Recording">
           Record
        </ion-toggle-->

        

          <button class="button button-full button-positive" id="but">Record</button>

<script>
$(document).ready(function(){




if(typeof(Storage) !== "undefined") {
$("#name1").val(window.localStorage.getItem("n1"));
$("#name2").val(window.localStorage.getItem("n2"));
$("#name3").val(window.localStorage.getItem("n3"));
$("#name4").val(window.localStorage.getItem("n4"));
$("#name5").val(window.localStorage.getItem("n5"));
} else {
    // No HTML5 Storage Support
}

//while(true){
//var go = $("#{{Record").val();}
$( "#but" ).click(function() {
//if(toggled){
    //alert('lol');


var name1 = $("#name1").val();
var name2 = $("#name2").val();
var name3 = $("#name3").val();
var name4 = $("#name4").val();
var name5 = $("#name5").val();

var NA = "na.";
var KR = "www.";
var EUW = "euw.";
var LAS = "las.";
var EUNE = "eune.";
var BR = "br.";
var OCE = "oce.";
var RU = "ru.";
var TR = "tr.";
var LAN = "lan.";


var aname1 = $("#name1").val().split(':');
var aname2 = $("#name2").val().split(':');
var aname3 = $("#name3").val().split(':');
var aname4 = $("#name4").val().split(':');
var aname5 = $("#name5").val().split(':');
//arrays. aname1[0] contains summonername aname1[1] contains region
var array = [aname1,aname2,aname3,aname4,aname5];
if(typeof(Storage) !== "undefined") {
window.localStorage.setItem("n1", name1);
window.localStorage.setItem("n2", name2);
window.localStorage.setItem("n3", name3);
window.localStorage.setItem("n4", name4);
window.localStorage.setItem("n5", name5);
//storing in format name:region


} else {
    // No HTML5 Storage Support
}
var z = 0;
while(z<5){
var un = array[z];
z++;
var loc;

//getting the correct server

if(un[1] == "NA"){loc = NA;}
if(un[1] == "KR"){loc = KR;}
if(un[1] == "EUW"){loc = EUW;}
if(un[1] == "OCE"){loc = OCE;}
if(un[1] == "LAS"){loc = LAS;}
if(un[1] == "RU"){loc = RU;}
if(un[1] == "EUNE"){loc = EUNE;}
if(un[1] == "BR"){loc = BR;}
if(un[1] == "LAN"){loc = LAN;}
if(un[1] == "TR"){loc = TR;}


$.ajax({
   type: "POST",
   url: "http://" + loc + "op.gg/summoner/ajax/spectator/",
   dataType: "text",
   data: {userName: (un[0]),force:'true'},
   success: function(data) {
    //var obj = $.parseJSON(data);
//alert(data);
//$(data).filter('#').doStuff();
            //alert("GREAT SUCCESS!!!111!!");

var where = data.indexOf("requestRecording");
var get = data.indexOf("gameId=");
if(!(where > -1)){console.log("Game not currently recordable.")}
//alert(data.getElementsByClassName(kajax opButton mini red));
//console.log($(data).find('requestRecording'));
//value = data.find('a.kajax.op.Button.mini.red');
//   console.log(value);
console.log(get);
var res = data.substring(get+7, get+17);
console.log(res);

$.ajax({

    url : 'http://na.op.gg/summoner/ajax/requestRecording.json/gameId=' + res,
    type : 'GET',
    dataType:'json',
    success : function(data) {              
        console.log("Success");
    },
    error : function(request,error)
    {
        console.log(("Request: "+JSON.stringify(request)));
    }
});




//console.log($( "div.RequestRecording tip").html());





   },
   error: function(e) {
     console.log('Error: ' + e.message);
   }
});


}//end of the while loop through 5 names






//$.ajax({
  // type: "GET",
   //url: "http://na.op.gg/summoner/ajax/requestRecording.json/gameId=" + res
//});
//$.get( "http://na.op.gg/summoner/ajax/requestRecording.json/gameId=" + res);

//here is where the inside of the click is


}); //this was only removed because onlick no more use
//}  //for the toggling thingy that sucks

/**
$( "#but" ).click(function() {
$.ajax({

    url : 'http://na.op.gg/summoner/ajax/requestRecording.json/gameId=' + res,
    type : 'GET',
    dataType:'json',
    success : function(data) {              
        console.log("Success");
    },
    error : function(request,error)
    {
        console.log(("Request: "+JSON.stringify(request)));
    }
});

});
**/


  //alert( "Handler for .click() called." );
});





</script>






        </div>









    <!-- our list and list items -->
    <ion-list>
      <!--<ion-item ng-repeat="task in tasks">

      </ion-item> -->
    </ion-list>
  </ion-content>
</ion-side-menu-content>


      </ion-content>
    </ion-side-menu-content>

    <!-- Left menu -->
    <ion-side-menu side="left">
      <ion-header-bar class="bar-positive">
        <h1 class="title"></h1>
      </ion-header-bar>
    </ion-side-menu>

  </ion-side-menus>



  </body>
</html>
